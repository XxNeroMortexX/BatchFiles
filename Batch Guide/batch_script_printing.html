<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Batch Script Tutorial</title>
<meta charset="utf-8">
<link id="style-switch" rel="stylesheet" href="css/style-min.css">
<link rel="stylesheet" href="css/custom.css">
<style>.navbar-expand-xl .navbar-brand .navbar-brand-item, .h-100px, ul.toc li.heading, .light-mode-item, .dark-mode-item, .back-top, a.demo, .home-intro-sub{background:#17c06a; color:#fff;}  ul.toc li.heading:hover{background:#17c06a;} .btn-grey-border{background:#17c06a; color:#fff; border:1px solid #17c06a;} .course-box{background:#17c06a;} 
</style>
</head>
<body>



<main class="bg-light pb-4">
<div class="container-fluid mt-3 px-3 px-xl-3">
<div class="row g-4">
<div class="col-sm-12 col-md-4 col-xl-3 ps-0 pe-0 collapse tutorial-toc" id="tocCollapse">
<div class="card card-body bg-light pt-0">
<ul class="toc chapters">
<li class="heading">Batch Script Tutorial</li>
<li><a href="index-2.html">Batch Script - Home</a></li>
<li><a href="batch_script_overview.html">Batch Script - Overview</a></li>
<li><a href="batch_script_environment.html">Batch Script - Environment</a></li>
<li><a href="batch_script_commands.html">Batch Script - Commands</a></li>
<li><a href="batch_script_files.html">Batch Script - Files</a></li>
<li><a href="batch_script_syntax.html">Batch Script - Syntax</a></li>
<li><a href="batch_script_variables.html">Batch Script - Variables</a></li>
<li><a href="batch_script_comments.html">Batch Script - Comments</a></li>
<li><a href="batch_script_strings.html">Batch Script - Strings</a></li>
<li><a href="batch_script_arrays.html">Batch Script - Arrays</a></li>
<li><a href="batch_script_decision_making.html">Batch Script - Decision Making</a></li>
<li><a href="batch_script_operators.html">Batch Script - Operators</a></li>
<li><a href="batch_script_date_time.html">Batch Script - DATE &amp; TIME</a></li>
<li><a href="batch_script_input_output.html">Batch Script - Input / Output</a></li>
<li><a href="batch_script_return_code.html">Batch Script - Return Code</a></li>
<li><a href="batch_script_functions.html">Batch Script - Functions</a></li>
<li><a href="batch_script_process.html">Batch Script - Process</a></li>
<li><a href="batch_script_aliases.html">Batch Script - Aliases</a></li>
<li><a href="batch_script_devices.html">Batch Script - Devices</a></li>
<li><a href="batch_script_registry.html">Batch Script - Registry</a></li>
<li><a href="batch_script_network.html">Batch Script - Network</a></li>
<li><a href="batch_script_printing.html">Batch Script - Printing</a></li>
<li><a href="batch_script_debugging.html">Batch Script - Debugging</a></li>
<li><a href="batch_script_logging.html">Batch Script - Logging</a></li>
</ul>
<ul class="toc chapters">
<li class="heading">Batch Script Resources</li>
<li><a href="batch_script_quick_guide.html">Batch Script - Quick Guide</a></li>
</ul>
</div>
</div>
<!-- Tutorial ToC Ends Here -->


<!-- Tutorial Content Starts Here -->
<div class="col-sm-12 col-md-8 col-xl-6 rounded-3 tutorial-content" id="mainContent">

<h1>Batch Script - Printing</h1>
<hr />

<br>
<div class="mui-container-fluid button-borders">
<div class="pre-btn">
<a href="batch_script_network.html"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="batch_script_debugging.html">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>

<div class="clearer"></div>
<p>Printing can also be controlled from within Batch Script via the NET PRINT command.</p>
<h3>Syntax</h3>
<pre class="result notranslate">
PRINT [/D:device] [[drive:][path]filename[...]]
</pre>
<p>Where /D:device - Specifies a print device.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
print c:\example.txt /c /d:lpt1
</pre>
<p>The above command will print the example.txt file to the parallel port lpt1.</p>
<h2>Command Line Printer Control</h2>
<p>As of Windows 2000, many, but not all, printer settings can be configured from Windows's command line using PRINTUI.DLL and RUNDLL32.EXE</p>
<h3>Syntax</h3>
<pre class="result notranslate">
RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry [ <i>options</i> ] [ &commat;<i>commandfile</i> ]
</pre>
<p>Where some of the options available are the following &minus;</p>
<ul class="list">
<li><p><b>/dl</b> &minus; Delete local printer.</p></li>
<li><p><b>/dn</b> &minus; Delete network printer connection.</p></li>
<li><p><b>/dd</b> &minus; Delete printer driver.</p></li>
<li><p><b>/e</b> &minus; Display printing preferences.</p></li>
<li><p><b>/f[file]</b> &minus; Either inf file or output file.</p></li>
<li><p><b>/F[file]</b> &minus; Location of an INF file that the INF file specified with /f may depend on.</p></li>
<li><p><b>/ia</b> &minus; Install printer driver using inf file.</p></li>
<li><p><b>/id</b> &minus; Install printer driver using add printer driver wizard.</p></li>
<li><p><b>/if</b> &minus; Install printer using inf file.</p></li>
<li><p><b>/ii</b> &minus; Install printer using add printer wizard with an inf file.</p></li>
<li><p><b>/il</b> &minus; Install printer using add printer wizard.</p></li>
<li><p><b>/in</b> &minus; Add network printer connection.</p></li>
<li><p><b>/ip</b> &minus; Install printer using network printer installation wizard.</p></li>
<li><p><b>/k</b> &minus; Print test page to specified printer, cannot be combined with command when installing a printer.</p></li>
<li><p><b>/l[path]</b> &minus; Printer driver source path.</p></li>
<li><p><b>/m[model]</b> &minus; Printer driver model name.</p></li>
<li><p><b>/n[name]</b> &minus; Printer name.</p></li>
<li><p><b>/o</b> &minus; Display printer queue view.</p></li>
<li><p><b>/p</b> &minus; Display printer properties.</p></li>
<li><p><b>/Ss</b> &minus; Store printer settings into a file.</p></li>
<li><p><b>/Sr</b> &minus; Restore printer settings from a file.</p></li>
<li><p><b>/y</b> &minus; Set printer as the default.</p></li>
<li><p><b>/Xg</b> &minus; Get printer settings.</p></li>
<li><p><b>/Xs</b> &minus; Set printer settings.</p></li>
</ul>
<h2>Testing if a Printer Exists</h2>
<p>There can be cases wherein you might be connected to a network printer instead of a local printer. In such cases, it is always beneficial to check if a printer exists in the first place before printing.</p>
<p>The existence of a printer can be evaluated with the help of the RUNDLL32.EXE PRINTUI.DLL which is used to control most of the printer settings.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
SET PrinterName = Test Printer
SET file=%TEMP%\Prt.txt
RUNDLL32.EXE PRINTUI.DLL,PrintUIEntry /Xg /n "%PrinterName%" /f "%file%" /q

IF EXIST "%file%" (
   ECHO %PrinterName% printer exists
) ELSE (
   ECHO %PrinterName% printer does NOT exists
)
</pre>
<p>The above command will do the following &minus;</p>
<ul class="list">
<li><p>It will first set the printer name and set a file name which will hold the settings of the printer.</p></li>
<li><p>The RUNDLL32.EXE PRINTUI.DLL commands will be used to check if the printer actually exists by sending the configuration settings of the file to the file Prt.txt</p></li>
</ul>
<div class="d-flex justify-content-between border-bottom border-top py-2" id="bottom_navigation">
<a href="batch_script_network.html" class="pre-btn"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
<a id="print-page" href="#" class="pre-btn d-none d-sm-block"><i class="fal fa-print"></i> Print Page</a>
<a href="batch_script_debugging.html" class="nxt-btn">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>

</body>

<!-- Mirrored from www.tutorialspoint.com/batch_script/batch_script_printing.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Sep 2022 22:54:53 GMT -->
</html>
