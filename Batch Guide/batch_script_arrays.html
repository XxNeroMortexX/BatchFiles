<!DOCTYPE html>
<html lang="en-US">
<head>
<title>Batch Script Tutorial</title>
<meta charset="utf-8">
<link id="style-switch" rel="stylesheet" href="css/style-min.css">
<link rel="stylesheet" href="css/custom.css">
<style>.navbar-expand-xl .navbar-brand .navbar-brand-item, .h-100px, ul.toc li.heading, .light-mode-item, .dark-mode-item, .back-top, a.demo, .home-intro-sub{background:#17c06a; color:#fff;}  ul.toc li.heading:hover{background:#17c06a;} .btn-grey-border{background:#17c06a; color:#fff; border:1px solid #17c06a;} .course-box{background:#17c06a;} 
</style>
</head>
<body>



<main class="bg-light pb-4">
<div class="container-fluid mt-3 px-3 px-xl-3">
<div class="row g-4">
<div class="col-sm-12 col-md-4 col-xl-3 ps-0 pe-0 collapse tutorial-toc" id="tocCollapse">
<div class="card card-body bg-light pt-0">
<ul class="toc chapters">
<li class="heading">Batch Script Tutorial</li>
<li><a href="index-2.html">Batch Script - Home</a></li>
<li><a href="batch_script_overview.html">Batch Script - Overview</a></li>
<li><a href="batch_script_environment.html">Batch Script - Environment</a></li>
<li><a href="batch_script_commands.html">Batch Script - Commands</a></li>
<li><a href="batch_script_files.html">Batch Script - Files</a></li>
<li><a href="batch_script_syntax.html">Batch Script - Syntax</a></li>
<li><a href="batch_script_variables.html">Batch Script - Variables</a></li>
<li><a href="batch_script_comments.html">Batch Script - Comments</a></li>
<li><a href="batch_script_strings.html">Batch Script - Strings</a></li>
<li><a href="batch_script_arrays.html">Batch Script - Arrays</a></li>
<li><a href="batch_script_decision_making.html">Batch Script - Decision Making</a></li>
<li><a href="batch_script_operators.html">Batch Script - Operators</a></li>
<li><a href="batch_script_date_time.html">Batch Script - DATE &amp; TIME</a></li>
<li><a href="batch_script_input_output.html">Batch Script - Input / Output</a></li>
<li><a href="batch_script_return_code.html">Batch Script - Return Code</a></li>
<li><a href="batch_script_functions.html">Batch Script - Functions</a></li>
<li><a href="batch_script_process.html">Batch Script - Process</a></li>
<li><a href="batch_script_aliases.html">Batch Script - Aliases</a></li>
<li><a href="batch_script_devices.html">Batch Script - Devices</a></li>
<li><a href="batch_script_registry.html">Batch Script - Registry</a></li>
<li><a href="batch_script_network.html">Batch Script - Network</a></li>
<li><a href="batch_script_printing.html">Batch Script - Printing</a></li>
<li><a href="batch_script_debugging.html">Batch Script - Debugging</a></li>
<li><a href="batch_script_logging.html">Batch Script - Logging</a></li>
</ul>
<ul class="toc chapters">
<li class="heading">Batch Script Resources</li>
<li><a href="batch_script_quick_guide.html">Batch Script - Quick Guide</a></li>
</ul>
</div>
</div>
<!-- Tutorial ToC Ends Here -->


<!-- Tutorial Content Starts Here -->
<div class="col-sm-12 col-md-8 col-xl-6 rounded-3 tutorial-content" id="mainContent">

<h1>Batch Script - Arrays</h1>
<hr/>

<br>
<div class="mui-container-fluid button-borders">
<div class="pre-btn">
<a href="batch_script_strings.html"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="batch_script_decision_making.html">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>
</div>

<div class="clearer"></div>
<p>Arrays are not specifically defined as a type in Batch Script but can be implemented. The following things need to be noted when arrays are implemented in Batch Script.</p>
<ul class="list">
<li>Each element of the array needs to be defined with the set command.</li>
<li>The ‘for’ loop would be required to iterate through the values of the array.</li>
</ul>
<h2>Creating an Array</h2>
<p>An array is created by using the following set command.</p>
<pre class="result notranslate">
set a[0]=1
</pre> 
<p>Where 0 is the index of the array and 1 is the value assigned to the first element of the array.</p>
<p>Another way to implement arrays is to define a list of values and iterate through the list of values. The following example show how this can be implemented.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set list=1 2 3 4 
(for %%a in (%list%) do ( 
   echo %%a 
))
</pre>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
1
2
3
4
</pre>
<h2>Accessing Arrays</h2>
<p>You can retrieve a value from the array by using subscript syntax, passing the index of the value you want to retrieve within square brackets immediately after the name of the array.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0]=1 
echo %a[0]%
</pre>
<p>In this example, the index starts from 0 which means the first element can be accessed using index as 0, the second element can be accessed using index as 1 and so on. Let's check the following example to create, initialize and access arrays &minus;</p>
<pre class="prettyprint notranslate">
&commat;echo off
set a[0]=1 
set a[1]=2 
set a[2]=3 
echo The first element of the array is %a[0]% 
echo The second element of the array is %a[1]% 
echo The third element of the array is %a[2]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The first element of the array is 1 
The second element of the array is 2 
The third element of the array is 3
</pre>
<h2>Modifying an Array</h2>
<p>To add an element to the end of the array, you can use the set element along with the last index of the array element.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0]=1  
set a[1]=2  
set a[2]=3 
Rem Adding an element at the end of an array 
Set a[3]=4 
echo The last element of the array is %a[3]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The last element of the array is 4
</pre>
<p>You can modify an existing element of an Array by assigning a new value at a given index as shown in the following example &minus;</p>
<pre class="prettyprint notranslate">
&commat;echo off 
set a[0]=1 
set a[1]=2  
set a[2]=3 
Rem Setting the new value for the second element of the array 
Set a[1]=5 
echo The new value of the second element of the array is %a[1]%
</pre>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
The new value of the second element of the array is 5
</pre>
<h2>Iterating Over an Array</h2>
<p>Iterating over an array is achieved by using the ‘for’ loop and going through each element of the array. The following example shows a simple way that an array can be implemented.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
setlocal enabledelayedexpansion 
set topic[0]=comments 
set topic[1]=variables 
set topic[2]=Arrays 
set topic[3]=Decision making 
set topic[4]=Time and date 
set topic[5]=Operators 

for /l %%n in (0,1,5) do ( 
   echo !topic[%%n]! 
)
</pre>
<p>Following things need to be noted about the above program &minus;</p>
<ul class="list">
<li><p>Each element of the array needs to be specifically defined using the set command.</p></li>
<li><p>The ‘for’ loop with the /L parameter for moving through ranges is used to iterate through the array.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Comments 
variables 
Arrays 
Decision making 
Time and date 
Operators
</pre>
<h2>Length of an Array</h2>
<p>The length of an array is done by iterating over the list of values in the array since there is no direct function to determine the number of elements in an array.</p>
<pre class="prettyprint notranslate">
&commat;echo off 
set Arr[0]=1 
set Arr[1]=2 
set Arr[2]=3 
set Arr[3]=4 
set "x = 0" 
:SymLoop 

if defined Arr[%x%] ( 
   call echo %%Arr[%x%]%% 
   set /a "x&plus;=1"
   GOTO :SymLoop 
)
echo "The length of the array is" %x%
</pre>
<h3>Output</h3>
<p>Output The above command produces the following output.</p>
<pre class="result notranslate">
1
2
3
4
"The length of the array is" 4
</pre>
<h2>Creating Structures in Arrays</h2>
<p>Structures can also be implemented in batch files using a little bit of an extra coding for implementation. The following example shows how this can be achieved.</p>
<h3>Example</h3>
<pre class="prettyprint notranslate">
@echo off 
set obj[0].Name=Joe 
set obj[0].ID=1 
set obj[1].Name=Mark 
set obj[1].ID=2 
set obj[2].Name=Mohan 
set obj[2].ID=3 
FOR /L %%i IN (0 1 2) DO  (
   call echo Name = %%obj[%%i].Name%%
   call echo Value = %%obj[%%i].ID%%
)
</pre>
<p>The following key things need to be noted about the above code.</p>
<ul class="list">
<li><p>Each variable defined using the set command has 2 values associated with each index of the array.</p></li>
<li><p>The variable <b>i</b> is set to 0 so that we can loop through the structure will the length of the array which is 3.</p></li>
<li><p>We always check for the condition on whether the value of i is equal to the value of <b>len</b> and if not, we loop through the code.</p></li>
<li><p>We are able to access each element of the structure using the obj[%i%] notation.</p></li>
</ul>
<h3>Output</h3>
<p>The above command produces the following output.</p>
<pre class="result notranslate">
Name=Joe 
Value=1 
Name=Mark 
Value=2 
Name=Mohan 
Value=3
</pre>
<div class="d-flex justify-content-between border-bottom border-top py-2" id="bottom_navigation">
<a href="batch_script_strings.html" class="pre-btn"><i class="fal fa-chevron-circle-left"></i> Previous Page</a>
<a id="print-page" href="#" class="pre-btn d-none d-sm-block"><i class="fal fa-print"></i> Print Page</a>
<a href="batch_script_decision_making.html" class="nxt-btn">Next Page <i class="fal fa-chevron-circle-right"></i>&nbsp;</a>
</div>

</body>

<!-- Mirrored from www.tutorialspoint.com/batch_script/batch_script_arrays.htm by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 06 Sep 2022 22:54:37 GMT -->
</html>
